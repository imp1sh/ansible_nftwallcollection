# Generated by Ansible
auto lo
iface lo inet loopback

{% for interface in netinterfaces %}
# Interface Name: {{ interface.name|default("unspecified", true) }}
auto {{ interface.interface }}
{% if interface.method is defined %}
{% if interface.method == 'static' and interface.ip is defined %}
iface {{ interface.interface }} inet static
	address {{ interface.ip | ipaddr('address') }}
	netmask {{ interface.ip | ipaddr('netmask') }}
{% if interface.gateway is defined %}
	gateway {{ interface.gateway }}
{% endif %}
{% if interface.bridgeports is defined %}
	bridge-ports {{ interface.bridgeports }}
{% endif %}
{% if interface.bridgestp is defined %}
	bridge-stp {{ interface.bridgestp }}
{% endif %}
{% if interface.postup is defined %}
	post-up {{ interface.postup }}
{% endif %}
{% if interface.up is defined %}
	up {{ interface.up }}
{% endif %}
{% elif interface.method == 'dhcp' %}
iface {{ interface.interface }} inet dhcp
{% if interface.bridgeports is defined %}
	bridge-ports {{ interface.bridgeports }}
{% endif %}
{% if interface.bridgestp is defined %}
	bridge-stp {{ interface.bridgestp }}
{% endif %}
{% if interface.postup is defined %}
	post-up {{ interface.postup }}
{% endif %}
{% if interface.up is defined %}
	up {{ interface.up }}
{% endif %}
{% elif interface.method == 'manual' %}
iface {{ interface.interface }} inet manual
{% if interface.bridgeports is defined %}
	bridge-ports {{ interface.bridgeports }}
{% endif %}
{% if interface.bridgestp is defined %}
	bridge-stp {{ interface.bridgestp }}
{% endif %}
{% if interface.postup is defined %}
	post-up {{ interface.postup }}
{% endif %}
{% if interface.up is defined %}
	up {{ interface.up }}
{% endif %}
{% endif %}
{% endif %}
{% if interface.method6 is defined %}
{% if interface.method6 == 'static' %}
iface {{ interface.interface }} inet6 static
	address {{ interface.ip6 | ipaddr('address') }}
	netmask {{ interface.ip6 | ipaddr('prefix')}}
{% if interface.gateway6 is defined %}
	gateway {{ interface.gateway6 }}
{% endif %}
{% if interface.up6 is defined %}
	up {{ interface.up6 }}
{% endif %}
{% if interface.postup6 is defined %}
	post-up {{ interface.postup6 }}
{% endif %}

{% if secondaryips is defined %}
{% for element in secondaryips %}
iface {{ ansible_facts['default_ipv6']['interface'] }} inet6 static
	address {{ element.ipaddress }}
	netmask 128
{% endfor %}
{% endif %}

{% elif interface.method6 == 'slaac' %}
iface {{ interface.interface }} inet6 manual
	pre-up echo 2 > /proc/sys/net/ipv6/conf/{{ interface.interface }}/accept_ra
{% endif %}
{% endif %}
{% endfor %}

