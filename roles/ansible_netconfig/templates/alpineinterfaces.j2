# Generated by Ansible
auto lo
iface lo inet loopback

{% for key, value in netinterfaces.items() %}
# Interface Name: {{ value.comment|default("unspecified", true) }}
auto {{ key }}
{% if value.method is defined %}
{% if value.method == 'static' and value.ip4 is defined %}
iface {{ key }} inet static
	address {{ value.ip4 | ipaddr('address') }}
	netmask {{ value.ip4 | ipaddr('netmask') }}
{% if value.gw4 is defined %}
	gateway {{ value.gw4 }}
{% endif %}
{% if value.children is defined %}
	bridge-ports {{ value.children | join(' ') }}
{% endif %}
{% if value.bridgestp is defined %}
	bridge-stp {{ value.bridgestp }}
{% endif %}
{% if value.postup is defined %}
	post-up {{ value.postup }}
{% endif %}
{% if value.up is defined %}
	up {{ value.up }}
{% endif %}
{% elif value.method == 'dhcp' %}
iface {{ key }} inet dhcp
{% if value.bridgeports is defined %}
	bridge-ports {{ value.bridgeports | join(' ') }}
{% endif %}
{% if value.bridgestp is defined %}
	bridge-stp {{ value.bridgestp }}
{% endif %}
{% if value.postup is defined %}
	post-up {{ value.postup }}
{% endif %}
{% if value.up is defined %}
	up {{ value.up }}
{% endif %}
{% elif value.method == 'manual' %}
iface {{ key }} inet manual
{% if value.children is defined %}
	bridge-ports {{ value.children(' ') }}
{% endif %}
{% if value.bridgestp is defined %}
	bridge-stp {{ value.bridgestp }}
{% endif %}
{% if value.postup is defined %}
	post-up {{ value.postup }}
{% endif %}
{% if value.up is defined %}
	up {{ value.up }}
{% endif %}
{% endif %}
{% endif %}
{% if value.method6 is defined %}
{% if value.method6 == 'static' %}
iface {{ key }} inet6 static
	address {{ value.ip6 | ipaddr('address') }}
	netmask {{ value.ip6 | ipaddr('prefix')}}
{% if value.gw6 is defined %}
	gateway {{ value.gw6 }}
{% endif %}
{% if value.up6 is defined %}
	up {{ value.up6 }}
{% endif %}
{% if value.postup6 is defined %}
	post-up {{ value.postup6 }}
{% endif %}

{% if secondaryips is defined %}
{% for element in secondaryips %}
iface {{ ansible_facts['default_ipv6']['interface'] }} inet6 static
	address {{ element.ipaddress }}
	netmask 128
{% endfor %}
{% endif %}

{% elif value.method6 == 'slaac' %}
iface {{ key }} inet6 manual
	pre-up echo 2 > /proc/sys/net/ipv6/conf/{{ key }}/accept_ra
{% endif %}
{% endif %}
{% endfor %}

